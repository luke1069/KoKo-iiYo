<%= render "homes/sidebar" %>

<div class="container-fluid">
  <div class="row">
    <div class="col-2 col-md-1" style="height: 1px;"></div>
    <div class="top col-10 col-md-11 my-2">
      <div id="box">
        <div id="images">
          <!--<img src="/assets/topimage5.jpg" class="image1">-->
          <!--<img src="/assets/topimage4.jpg" class="image2">-->
          <!--<img src="/assets/topimage3.jpg" class="image3">-->
          <!--<img src="/assets/topimage2.jpg" class="image4">-->
          <!--<img src="/assets/topimage1.jpg" class="image5">-->
          <div class="image1 img-fluid">
          </div>
          <div class="image2 img-fluid">
          </div>
          <div class="image3 img-fluid">
          </div>
          <div class="image4 img-fluid">
          </div>
          <div class="image5 img-fluid">
          </div>
        </div>
      </div>
      <div class="introduction text-center text-light">
        <div class="main-intro">
          <h4>バイク専用SNS</h4>
          <h4><span class="title">「KoKo-iiYo」</span>へようこそ</h4>
        </div>
        <p>あなたのバイク、おすすめスポットの写真を投稿しましょう。</p>
        <% unless user_signed_in? %>
          <p>ご利用にはユーザー登録が必要となります。登録は<%= link_to new_user_registration_path do %>『こちら』<% end %>から</p>
        <% end %>
        <p>交通規則を遵守し、安全なバイクライフを過ごしましょう！</p>
        <% if user_signed_in? %>
          <p><i class="far fa-arrow-alt-circle-down"></i>から<strong>「新着の投稿一覧」「人気の投稿一覧」</strong>を確認することができます。</p>
        <% end %>
      </div>
    </div>
  </div>

  <% if user_signed_in? %>
    <div class="row">
      <div class="col-2 col-md-1" style="height: 1px;"></div>
      <div class="col-10 col-md-11 my-2 p-2">
        <%= link_to posts_path, 'data-turbolinks': false do %>
          <h3 class="sub-title">新着の投稿</h3>
        <% end %>
        <div class="row">
          <% @posts_new.first(4).each do |post| %>
            <div class="top-posts col-11 col-md-5 my-2 mx-auto p-2 border">
              <%= link_to post_path(post), 'data-turbolinks': false do %>
                <%= attachment_image_tag post, :image, fallback: "no_image.jpg", class:"post_or_user_image border" %>
              <% end %>
              <div class="fontawesomes">
                <strong>
                  <span id="favorite_buttons_<%= post.id %>">
                    <%= render "favorites/favorite", post: post %>
                  </span>
                  <span>
                    <i class="far fa-eye ml-3"></i><%= post.impressions_counts.count %>
                  </span>
                  <span>
                    <i class="far fa-comments ml-3"></i><%= post.comments.count %>
                  </span>
                </strong>
                <span>
                  <i class="fas fa-clock ml-3"></i>(<%= post.created_at.strftime('%Y/%m/%d %H:%M') %>)
                </span>
                <div id="star-rate-<%= post.id %>"></div>
                <script>
                  $('#star-rate-<%= post.id %>').empty();
                  $('#star-rate-<%= post.id %>').raty({
                    size: 36,
                    starOff:  '<%= asset_path('star-off.png') %>',
                    starOn : '<%= asset_path('star-on.png') %>',
                    starHalf: '<%= asset_path('star-half.png') %>',
                    half: true,
                    readOnly: true,
                    score: <%= post.rate %>,
                  });
                </script>
              </div>
              <div class="row">
                <div class="col-7">
                  <%= link_to post_path(post), 'data-turbolinks': false do %>
                    <strong>タイトル</strong><br>
                    『<%= post.title %>』
                    <br>
                    <strong>場所</strong><br>
                    <%= post.post_prefecture %>
                    <br>
                    <strong>おすすめのポイント</strong><br>
                    <%= post.body.truncate(50) %>
                  <% end %>
                </div>
                <div class="col-5">
                  <strong>投稿</strong><br>
                  <%= link_to user_path(post.user_id), 'data-turbolinks': false do %>
                    <%= attachment_image_tag post.user, :profile_image, fallback: "no_image.jpg", class:"post_or_user_image border" %>
                    <%= post.user.name %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>

        </div>
        <%= link_to posts_path, 'data-turbolinks': false do %>
          <h3 class="sub-title m-4 text-right"><i class="fas fa-arrow-circle-right"></i> 新着の投稿一覧へ</h3>
        <% end %>

        <%= link_to ranking_index_path, 'data-turbolinks': false do %>
          <h3 class="sub-title">人気の投稿</h3>
        <% end %>
        <div class="row">
          <% @posts_favorite.first(4).each do |post| %>
            <div class="top-posts col-11 col-md-5 my-2 mx-auto p-2 w-100 border">
              <%= link_to post_path(post), 'data-turbolinks': false do %>
                <%= attachment_image_tag post, :image, fallback: "no_image.jpg", class:"post_or_user_image border" %>
              <% end %>
              <div class="fontawesomes">
                <strong>
                  <span id="favorite_buttons2_<%= post.id %>">
                    <%= render "favorites/favorite", post: post %>
                  </span>
                  <span>
                    <i class="far fa-eye ml-3"></i><%= post.impressions_counts.count %>
                  </span>
                  <span>
                    <i class="far fa-comments ml-3"></i><%= post.comments.count %>
                  </span>
                </strong>
                <span>
                  <i class="fas fa-clock ml-3"></i>(<%= post.created_at.strftime('%Y/%m/%d %H:%M') %>)
                </span>
                <div id="star-rate2-<%= post.id %>"></div>
                <script>
                  $('#star-rate2-<%= post.id %>').empty();
                  $('#star-rate2-<%= post.id %>').raty({
                    size: 36,
                    starOff:  '<%= asset_path('star-off.png') %>',
                    starOn : '<%= asset_path('star-on.png') %>',
                    starHalf: '<%= asset_path('star-half.png') %>',
                    half: true,
                    readOnly: true,
                    score: <%= post.rate %>,
                  });
                </script>
              </div>
              <div class="row">
                <div class="col-7">
                  <%= link_to post_path(post), 'data-turbolinks': false do %>
                    <strong>タイトル</strong><br>
                    『<%= post.title %>』
                    <br>
                    <strong>場所</strong><br>
                    <%= post.post_prefecture %>
                    <br>
                    <strong>おすすめのポイント</strong><br>
                    <%= post.body.truncate(50) %>
                  <% end %>
                </div>
                <div class="col-5">
                  <strong>投稿</strong><br>
                  <%= link_to user_path(post.user_id), 'data-turbolinks': false do %>
                    <%= attachment_image_tag post.user, :profile_image, fallback: "no_image.jpg", class:"post_or_user_image border" %>
                    <%= post.user.name %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
        <%= link_to ranking_index_path, 'data-turbolinks': false do %>
          <h3 class="sub-title m-4 text-right"><i class="fas fa-arrow-circle-right"></i> 人気の投稿一覧へ</h3>
        <% end %>
        <div style="height: 50px;"></div>


      </div>
    </div>
  <% else %>
  <% end %>

</div>